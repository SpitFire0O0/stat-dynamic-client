# ТЗ учебной системы STAT‑DYNAMIC (черновик)

## 1) Цели и принципы
- Декларативный UI: что показываем задаётся конфигами/схемами, компоненты переиспользуем без правок.
- На старте работаем с мок‑данными (fixtures), интеграции с API — позже (OpenAPI/DTO).
- Фокус на тех частях, под которые уже есть БД (Prisma) и готовые компоненты.

## 2) Роли и доступы
- Роли: Администрация (ADMIN), Учителя (TEACHER), Ученики (STUDENT), Родители (PARENT), Кураторы (CURATOR).
- Один пользователь может иметь несколько ролей.
- Примечание: в Prisma enum Permissions нет роли CURATOR — решить, добавляем ли её в бэкенд, либо маппим на существующие роли.
- Доступы задаются конфигом (маршруты, виджеты, разделы админки).

## 3) Глобальные статусы/пороги
- Пороговое окрашивание статусов (глобальный конфиг):
  - Невыполненные ДЗ: >=2 — жёлтый, >=3 — красный.
  - Пропуски занятий: >=2 — жёлтый, >=3 — красный.
- Используемо для виджетов и уведомлений.

## 4) Сущности (по Prisma) и ключевые связи
- User: login, ФИО, пол, permissions, контакты, токены, привязки к группам, сообщения, встречи.
- Group: name/slug, curatorId, студенты.
- Discipline → Course (year): темы (Theme), оценки (Grade), приоритеты (StudentPriority).
- Theme: принадлежит Course; имеет даты; связана с Grade и Homework.
- Meeting: тип (LESSON/EXAM/EVENT), curatorId, участники (MeetingUsers) с флагом посещения.
- Homework: тема, куратор, связи со студентами и студенческими решениями (StudentHomework).
- Grade: шкала A/B/C, тип (HOMEWORK/TEST/EXAM), связи student/teacher/course/theme.
- Feedback: комментарии/оценки по пользователю; связь с Meeting.
- Achievement: достижения пользователя; файлы.
- Dialog/Message: диалоги и сообщения (файлы прикрепляются к сообщениям).

## 5) Функциональные требования по ролям

Учителя
1) Списки детей по классам/группам; возможность разбивки класса на группы.
2) Тематическое планирование:
   - Заполнение тем на год; отметка A/B/C у темы.
   - Подтемы для длинных тем (промежуточная отметка).
3) Расписание:
   - Просмотр по классам и педагогам; фильтры по датам.
   - Отметка «Н» (нет на занятии) для студентов.
   - Запись домашнего задания.
4) Нагрузка:
   - Список учителей с предметами; список предметов.
   - Возможность вести несколько предметов.
   - Количество часов по предмету в год.
5) Аудит саморегуляции (ДЗ):
   - Кураторы: отметка «+/−» наличия выполненного ДЗ.
   - Учителя: выставление оценки за выполненное ДЗ.
6) Дневник наблюдений:
   - Комментарии об учениках по модулям (плюсы/минусы).
   - Связь с родителями через платформу.

Ученики
1) Расписание занятий.
2) Домашнее задание и статусы выполнения.
3) Просмотр комментариев учителей.
4) «Звонки» — уточнить формат (см. вопросы).

Родители
- Просмотр расписания/ДЗ ребёнка, комментариев учителя.
- Уведомления о невыполненных ДЗ и пропусках (в т.ч. в Telegram).

Администрация
- Полный доступ к данным и настройкам.

Кураторы
- Проверка факта выполнения ДЗ («+/−»), наблюдения.

Кружки (спец. кейс)
- Страница вида «таблица/матрица»: клуб/группа → список учеников.
- Поля:
  - Баллы/оценки активности от педагога.
  - Окно заметок учителя (плюсы/минусы, динамика наблюдений).
  - Поле для ежемесячных достижений ученика (круглый год) и отдельно трудностей/ошибок.
- Роли редактирования: учитель — свои заметки/баллы; ученик — собственные достижения/трудности; админ — всё; (куратор — по согласованию).

## 6) Уведомления
- Триггеры:
  - Невыполненные ДЗ (по порогам).
  - Много пропусков (по порогам).
- Каналы: Telegram для родителей, внутри платформы — для всех.
- Настройки частоты/мьют — позже.

## 7) Динамика/аналитика
- Просмотр трендов (успеваемость, посещаемость, выполнение ДЗ) по ученику/группе/курсу.
- Детализация по месяцам и темам.

## 8) Страницы/маршруты (MVP)
- Главная `/` — дашборд с базовыми виджетами (статистика, уроки, оценки, ДЗ, уведомления, быстрые действия).
- Профиль `/profile` — карточка, контакты, достижения, статистика.
- Домашки `/profile/homework` — список и статусы выполнения.
- Сообщения `/messages` — контакты/чаты 1:1.
- Расписание `/schedule` — компактное и детальное представление (день/неделя) без смены реализации календаря.
- Библиотека `/docs` — материалы (MVP — список/поиск).
- Настройки `/settings` — базовые секции.
- Админка `/admin` — заготовки управления сущностями.
- Кружки `/clubs` — «Excel‑подобная» матрица (MVP — плейсхолдеры/фикстуры).

## 9) Непонятные моменты и вопросы (с краткими идеями)
- CURATOR в БД: добавлять в Prisma enum или маппить кураторов на TEACHER/ADMIN?
- «Звонки»: это расписание звонков (таблица времени по дням) или звонки как связь (аудио/видео)?
  - Идея: MVP — таблица времени звонков по школе/филиалу.
- Шкала оценок: A/B/C остаётся основной или нужна параллельная 5‑балльная?
  - Идея: хранить ABC, отображать мэппинг в UI (A=5, B=4, C=3).
- Нагрузка: часы — на уровне teacher+course+year или course+year?
  - Идея: хранить teacher_course_year с числом часов.
- Тематическое планирование: отметка A/B/C на подтемах тоже нужна?
  - Идея: флаг на подтеме для промежуточной отметки.
- Кружки: кто редактирует поля ученика — только ученик или учитель тоже может корректировать?
  - Идея: ученик редактирует свои достижения/трудности; учитель видит и комментирует; админ может править всё.
- Сообщения: нужны групповые чаты (класс/группа) или достаточно 1:1?
  - Идея: MVP — 1:1; групповое позже.
- Отсутствия «Н»: нужны причины (болезнь/уважительная/неуважительная)?
  - Идея: тип причины как справочник, опционально в MVP.
- Уведомления: кроме Telegram, нужны email/push?
  - Идея: MVP — Telegram+in‑app; остальное позже.

## 10) Технический подход (кратко)
- Конфиги: `GlobalConfig`, `Roles`, `Navigation`, схемы страниц, реестр виджетов.
- Источники данных: сначала fixtures, затем React Query + axios (OpenAPI DTO).
- Статусы/пороги: читаются из `GlobalConfig`.
- Календарь/расписание: используем текущую реализацию, конфигурируем только данные/фильтры.

## 11) Критерии готовности (MVP)
- Страницы перечислены в п.8 доступны; контент управляется декларативно (без hard‑code в компонентах).
- «Кружки» отображают плейсхолдеры с данными из фикстур; права редактирования определены в конфиге.
- Пороговая окраска поддерживается виджетами (жёлтый/красный) на мок‑данных.
- Навигация и роли управляются через конфигурацию, без правки компонентов.
